# 死锁的原因，条件，危害

>***死锁产生的原因***

    死锁的产生是在这样一种环境中：比如我们有两个进程AB，他们都需要资源1和资源2，

    当进程A持有资源1，进程B持有资源2的时候，他们都需要对方手上的进程，

    而一般操作系统又不允许抢占，这个时候就发生了死锁。 （进程互占资源）

>***产生死锁的危害***

当出现死锁时，进程永远不能完成，并且阻碍使用系统资源，阻止了其他作业开始执行，导致系统的资源利用率急剧下载，下面列举出一些比较直接的影响。

    (1)死锁会使进程得不到正确的结果。因为处于死锁状态的进程得不到所需的资源，不能向前推进，故得不到结果。

    (2)死锁会使资源的利用率降低。因为处于死锁状态的进程不释放已占有的资源，以至于这些资源不能被其他进程利用，故系统资源利用率降低。

    (3)死锁还会导致产生新的死锁。其它进程因请求不到死锁进程已占用的资源而无法向前推进，所以也会发生死锁。

>***死锁发生的必要条件***

    (1)**互斥条件**：一个资源只能被一个进程所占有，不能共享

    (2)**请求和保持条件**：一个进程请求资源失败时，它会等待而不是释放(对已获得的资源保持不放)

    (3)**不剥夺条件**一个进程在释放资源之前其他进程不能抢夺资源

    (4)**环路等待条件**在发生死锁时必然存在一个“进程—资源”的环形链

>***从死锁产生的原因未明可以设计一些方法去避免死锁的发生***

    （1）静态分配资源，一开始就把一个进程所需的全部资源都分配给它，但这样会降低资源的使用效率；

    （2）允许抢占，需要设置进程的优先级，高优先级的进程可以抢占低优先级的进程的资源；

    （3）把资源进行编号，申请资源必须按照资源的编号顺序来申请。

>如果死锁已经发生了，就需要去**解开死锁，其本质思想就是分配资源打破循环等待**

    （1）可以运行抢占，从一个或多个进程中抢出资源来给其他进程

    （2）也可以终止一些进程，来达到释放资源的目的

考点：n个进程互斥并发执行，每个进程需要r个资源，计算可以避免死锁现象的最少资源m

公式：m = n * (r - 1) + 1

举例：若在系统中有6个互斥并发进程，每个进程需要2个资源，那么使系统不发生死锁的资源的最少数目为多少？
其中 n = 6；r = 2；

m = n * (r - 1) + 1 = 6 * (2 - 1) + 1 = 7

所以，需要最少的资源数数为7
