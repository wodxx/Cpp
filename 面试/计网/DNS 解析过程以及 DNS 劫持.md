# DNS 解析过程以及DNS劫持

## DNS查询的过程

- 主机向本地域名服务器发起某个域名的DNS查询请求，如果本地域名服务器查询到对应IP，就返回结果;

- 否则本地域名服务器直接向根域名服务器发起DNS查询请求，要么返回结果，要么告诉本地域名服务器下一次的请求服务器IP地址，下一次的请求服务器可能是顶级域名服务器也可能还是根域名服务器，然后继续查询。

- 循环这样的步骤直到查询到结果，本地域名服务器拿到结果返回给主机.

- (当时能查到返给主机，查不到向根服务器请求查询，根服务器要么返回结果要么再给一个根服务器ip，继续查询，直到查询成功)

## DNS劫持

- 在完成整个域名解析的过程之后，并没有收到本该收到的IP地址，而是接收到了一个错误的IP地址。比如输入的网址是百度，但是却进入了奇怪的网址，并且地址栏依旧是百度。

- 在这个过程中，攻击者一般是修改了本地路由器的DNS地址，从而访问了一个伪造的DNS服务器，这个伪造的服务器解析域名的时候返回了一个攻击者精心设计的网站，这个网站可能和目标网站一模一样，当用户输入个人账户时，数据会发送给攻击者，从而造成个人财产的丢失

- (被伪造者修改了本地路由的DNS地址，导致找到了陷阱DNS服务器，从而得到了一个错误的网站)

## 预防DNS劫持

1. 准备多个域名，当某个域名被劫持时，暂时使用另一个

2. 手动修改DNS，在地址栏输入http://192.168.1.1，进入路由器配置，填写主DNS服务器为114.114.114.114，填写备用DNS服务器为8.8.8.8 

3. 修改路由器密码

4. 给运营商打投诉电话，讲明被劫持的情况
